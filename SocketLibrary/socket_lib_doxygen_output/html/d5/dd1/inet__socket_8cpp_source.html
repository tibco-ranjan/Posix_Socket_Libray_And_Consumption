<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>socketLibrary: tcpSocket/source/inet_socket.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">socketLibrary
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d5/dd1/inet__socket_8cpp_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">inet_socket.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d5/dd1/inet__socket_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="../../d9/dc9/inet__socket_8h.html">inet_socket.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="../../d3/d61/readLine_8h.html">readLine.h</a>&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="../../d4/d31/CLogger_8h.html">CLogger.h</a>&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keywordtype">void</span> *<a class="code" href="../../d9/dc9/inet__socket_8h.html#a294867ba9d7ff47e39d421134d8e12ab">get_in_addr</a></div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="../../d5/dd1/inet__socket_8cpp.html#a294867ba9d7ff47e39d421134d8e12ab">   15</a></span>&#160;(</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keyword">struct</span> sockaddr *sa</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;)</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">if</span> (sa-&gt;sa_family == AF_INET) {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <span class="keywordflow">return</span> &amp;(((<span class="keyword">struct </span>sockaddr_in*)sa)-&gt;sin_addr);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    }</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordflow">return</span> &amp;(((<span class="keyword">struct </span>sockaddr_in6*)sa)-&gt;sin6_addr);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;}</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;in_port_t <a class="code" href="../../d9/dc9/inet__socket_8h.html#a9cff4ecb4076bdcf7b759c9834d1f99b">get_in_port</a></div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="../../d5/dd1/inet__socket_8cpp.html#a9cff4ecb4076bdcf7b759c9834d1f99b">   36</a></span>&#160;(</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keyword">struct</span> sockaddr *sa</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;)</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;{</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">if</span> (sa-&gt;sa_family == AF_INET) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">return</span> (((<span class="keyword">struct</span> sockaddr_in*)sa)-&gt;sin_port);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">return</span> (((<span class="keyword">struct</span> sockaddr_in6*)sa)-&gt;sin6_port);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/dc9/inet__socket_8h.html#a88cba87b27a1dd999f206d996767578f">get_peer_addr_with_peer_sock</a></div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="../../d5/dd1/inet__socket_8cpp.html#a78a6df23c88377d800f99cf82e0ebe92">   62</a></span>&#160;(</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct</span> sockaddr *peer_sock, </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">char</span>* peer_name, </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *peer_port</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;{</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">if</span>(peer_sock == NULL) </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span>(peer_sock-&gt;sa_family == AF_INET)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keyword">struct </span>sockaddr_in *ipv4 = (<span class="keyword">struct </span>sockaddr_in*)&amp;peer_sock;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        *peer_port = ntohs(ipv4-&gt;sin_port);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        inet_ntop(AF_INET, &amp;ipv4-&gt;sin_addr, peer_name, INET_ADDRSTRLEN);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(peer_sock-&gt;sa_family == AF_INET6) </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keyword">struct </span>sockaddr_in6 *ipv6 = (<span class="keyword">struct </span>sockaddr_in6*)&amp;peer_sock;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        *peer_port = ntohs(ipv6-&gt;sin6_port);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        inet_ntop(AF_INET6, &amp;ipv6-&gt;sin6_addr, peer_name, INET6_ADDRSTRLEN);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/dc9/inet__socket_8h.html#a0d17436cdcdef6e93730b193008e9de8">get_peer_addr_with_peer_conn_fd</a></div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="../../d5/dd1/inet__socket_8cpp.html#ac700c2abf460e645046e03e32a9e40df">  104</a></span>&#160;(</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> fd, </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">char</span>* peer_name, </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *peer_port</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;) </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;{</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> who = <span class="stringliteral">&quot;get_peer_addr_with_peer_conn_fd&quot;</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keyword">struct </span>sockaddr_storage peer_sock;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    socklen_t len;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    len = <span class="keyword">sizeof</span>(peer_sock);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">int</span> status = 0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span>((status = getpeername(fd, (<span class="keyword">struct</span> sockaddr*)&amp;peer_sock, &amp;len)) == -1) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: getpeername failed with %s&quot;</span>, who, gai_strerror(status));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span>(peer_sock.ss_family == AF_INET)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keyword">struct </span>sockaddr_in *ipv4 = (<span class="keyword">struct </span>sockaddr_in*)&amp;peer_sock;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        *peer_port = ntohs(ipv4-&gt;sin_port);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        inet_ntop(AF_INET, &amp;ipv4-&gt;sin_addr, peer_name, INET_ADDRSTRLEN);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(peer_sock.ss_family == AF_INET6) </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keyword">struct </span>sockaddr_in6 *ipv6 = (<span class="keyword">struct </span>sockaddr_in6*)&amp;peer_sock;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        *peer_port = ntohs(ipv6-&gt;sin6_port);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        inet_ntop(AF_INET6, &amp;ipv6-&gt;sin6_addr, peer_name, INET6_ADDRSTRLEN);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/dd1/inet__socket_8cpp.html#a70c25ed2ad4733bb8647266c4f8b6ad1">SetSocketNonBlocking</a> </div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="../../d5/dd1/inet__socket_8cpp.html#a70c25ed2ad4733bb8647266c4f8b6ad1">  147</a></span>&#160;(</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> fd, </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">bool</span> is_non_blocking</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;{</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keywordflow">if</span> (fd &lt; 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <span class="keywordtype">int</span> flags = fcntl(fd, F_GETFL, 0);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="keywordflow">if</span> (flags == -1) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   flags = is_non_blocking ? (flags | O_NONBLOCK) : (flags &amp; ~O_NONBLOCK);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <span class="keywordflow">return</span> (fcntl(fd, F_SETFL, flags) == 0) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/dc9/inet__socket_8h.html#a4ee3418bf7bd63c0b37ba13023d3e1cc">inet_connect_blocking</a></div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="../../d5/dd1/inet__socket_8cpp.html#a4a3fdd60ad81e617e851af69f5d76b36">  171</a></span>&#160;(</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* host, </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* service, </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">int</span> sock_type, </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">int</span> *connect_fd</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;{</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">//const char* const who = &quot;inet_connect&quot;;</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    std::string who = <span class="stringliteral">&quot;inet_connect&quot;</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keyword">struct </span>addrinfo hints;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keyword">struct </span>addrinfo *servinfo, *res;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">int</span> sfd, rv=0, status=0;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordtype">char</span> s[INET6_ADDRSTRLEN];</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    memset(&amp;hints, 0, <span class="keyword">sizeof</span>(hints));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    hints.ai_canonname = NULL;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  hints.ai_addr = NULL;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  hints.ai_next = NULL;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    hints.ai_family = AF_UNSPEC;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    hints.ai_socktype = sock_type;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span>((status = getaddrinfo(host, service, &amp;hints, &amp;servinfo) != 0 )){</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: getaddrinfo failed with error =%s&quot;</span>, who.c_str(), gai_strerror(status));</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">for</span>(res=servinfo; res != NULL; res=servinfo-&gt;ai_next)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">if</span>((sfd = socket(res-&gt;ai_family, res-&gt;ai_socktype, res-&gt;ai_protocol)) == -1){</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: inet_connect failed&quot;</span>, who.c_str());</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        cout&lt;&lt;<span class="stringliteral">&quot;Trying to connect with the sfd=&quot;</span>&lt;&lt;sfd &lt;&lt;endl;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span>((rv = connect(sfd, res-&gt;ai_addr, res-&gt;ai_addrlen)) == -1)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: client connect call failed for socket fd=%d with error &#39;%s&#39; and errono = %d&quot;</span>, who.c_str(), sfd, gai_strerror(rv), <a class="code" href="../../d2/d3d/common_2README.html#afe75ee0c7e5a90ba6bb38426ea69b996">errno</a>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                close(sfd);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <span class="keywordflow">continue</span>;           </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        cout&lt;&lt;<span class="stringliteral">&quot;Scuccessfully connected to the sever &quot;</span>&lt;&lt;host &lt;&lt;<span class="stringliteral">&quot; on the port=&quot;</span> &lt;&lt;service &lt;&lt;endl;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">break</span>; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span>( res != NULL)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        inet_ntop(res-&gt;ai_family, <a class="code" href="../../d9/dc9/inet__socket_8h.html#a294867ba9d7ff47e39d421134d8e12ab">get_in_addr</a>((<span class="keyword">struct</span> sockaddr *)res-&gt;ai_addr), s, <span class="keyword">sizeof</span>(s));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordtype">short</span> port_num = ntohs(<a class="code" href="../../d9/dc9/inet__socket_8h.html#a9cff4ecb4076bdcf7b759c9834d1f99b">get_in_port</a>((<span class="keyword">struct</span> sockaddr *)res-&gt;ai_addr));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: client: connecting to address:: %s  with port %d&quot;</span>, who.c_str(), s, port_num); </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: client failed to connect to the server&quot;</span>, who.c_str());</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    *connect_fd = sfd;  </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    freeaddrinfo(servinfo);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">return</span> sfd;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;}</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/dc9/inet__socket_8h.html#ab37ff95ca876cde433bb18cca94956f2">inet_connect_non_blocking</a></div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="../../d5/dd1/inet__socket_8cpp.html#af2136fd9f6dbbb026c1e6668a679bc84">  246</a></span>&#160;(</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* host, </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* service, </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">int</span> sock_type, </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordtype">int</span> *connect_fd</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;{</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">//const char* const who = &quot;inet_connect&quot;;</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    std::string who = <span class="stringliteral">&quot;inet_connect&quot;</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keyword">struct </span>addrinfo hints;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keyword">struct </span>addrinfo *servinfo, *res;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">int</span> sfd, rv=0, status=0, flags;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordtype">char</span> s[INET6_ADDRSTRLEN];</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    memset(&amp;hints, 0, <span class="keyword">sizeof</span>(hints));</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    hints.ai_canonname = NULL;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  hints.ai_addr = NULL;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  hints.ai_next = NULL;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    hints.ai_family = AF_UNSPEC;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    hints.ai_socktype = sock_type;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span>((status = getaddrinfo(host, service, &amp;hints, &amp;servinfo) != 0 )){</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: getaddrinfo failed with error =%s&quot;</span>, who.c_str(), gai_strerror(status));</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">for</span>(res=servinfo; res != NULL; res=servinfo-&gt;ai_next)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">if</span>((sfd = socket(res-&gt;ai_family, res-&gt;ai_socktype, res-&gt;ai_protocol)) == -1){</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: inet_connect failed&quot;</span>, who.c_str());</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        flags = fcntl(sfd, F_GETFL, 0);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordtype">bool</span> ret_non_blocking = <a class="code" href="../../d5/dd1/inet__socket_8cpp.html#a70c25ed2ad4733bb8647266c4f8b6ad1">SetSocketNonBlocking</a>(sfd, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">if</span>(<span class="keyword">false</span> == ret_non_blocking)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                        <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: Client failed to set connection socket in non blocking mode&quot;</span>, who.c_str());</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                        close(sfd);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">if</span>((rv = connect(sfd, res-&gt;ai_addr, res-&gt;ai_addrlen)) == -1)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                        <span class="comment">//As the socket is set into non blocking mode it </span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                        <span class="comment">//might failed with EINPROGRESS.</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                        <span class="keywordflow">if</span>( EINPROGRESS == <a class="code" href="../../d2/d3d/common_2README.html#afe75ee0c7e5a90ba6bb38426ea69b996">errno</a> ) </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                        {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                        cout&lt;&lt;<span class="stringliteral">&quot;connection to  &quot;</span>&lt;&lt;host &lt;&lt;<span class="stringliteral">&quot; on the port=&quot;</span> &lt;&lt;service &lt;&lt; <span class="stringliteral">&quot; is in progress&quot;</span> &lt;&lt;endl;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                        }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                        <span class="comment">//Connection completed immmediately.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( 0 == rv )</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                        {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                <span class="comment">/*resotre the sockt status flags*/</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                fcntl(sfd, F_SETFL, flags);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                        }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                        {   </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                        <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: client connect call failed for socket fd=%d with error &#39;%s&#39; and errono = %d&quot;</span>, who.c_str(), sfd, gai_strerror(rv), <a class="code" href="../../d2/d3d/common_2README.html#afe75ee0c7e5a90ba6bb38426ea69b996">errno</a>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                        close(sfd);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                        }           </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">break</span>; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">if</span>( res != NULL)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        inet_ntop(res-&gt;ai_family, <a class="code" href="../../d9/dc9/inet__socket_8h.html#a294867ba9d7ff47e39d421134d8e12ab">get_in_addr</a>((<span class="keyword">struct</span> sockaddr *)res-&gt;ai_addr), s, <span class="keyword">sizeof</span>(s));</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordtype">short</span> port_num = ntohs(<a class="code" href="../../d9/dc9/inet__socket_8h.html#a9cff4ecb4076bdcf7b759c9834d1f99b">get_in_port</a>((<span class="keyword">struct</span> sockaddr *)res-&gt;ai_addr));</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: client: connecting to address:: %s  with port %d&quot;</span>, who.c_str(), s, port_num); </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: client failed to connect to the server&quot;</span>, who.c_str());</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    *connect_fd = sfd;  </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    freeaddrinfo(servinfo);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">return</span> sfd;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/dc9/inet__socket_8h.html#a19ae7ff2c55d9c114a8effdcf9fae870">inet_passive</a></div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="../../d5/dd1/inet__socket_8cpp.html#ac15498a94781438281f5d283d3d1f6a2">  362</a></span>&#160;(</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* host,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* service, </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordtype">int</span> sock_type, </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordtype">bool</span> do_listen, </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordtype">int</span> backlog, </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordtype">int</span> *listen_fd,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordtype">bool</span> is_non_blocking)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;{</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">//const char* const who = &quot;inet_passive&quot;;</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    std::string  who = <span class="stringliteral">&quot;inet_passive&quot;</span>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keyword">struct </span>addrinfo hints;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keyword">struct </span>addrinfo *servinfo, *res;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordtype">int</span> sfd, yes=1, status=0;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    memset(&amp;hints, 0, <span class="keyword">sizeof</span>(hints));</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    hints.ai_canonname = NULL;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    hints.ai_addr = NULL;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    hints.ai_next = NULL;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    hints.ai_family = AF_UNSPEC;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    hints.ai_socktype = sock_type;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    hints.ai_flags = AI_PASSIVE;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span>((status = getaddrinfo(host, service, &amp;hints, &amp;servinfo) != 0 )){</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: getaddrinfo failed with error =%s&quot;</span>, who.c_str(), gai_strerror(status));</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">for</span>(res=servinfo; res != NULL; res=servinfo-&gt;ai_next){</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">if</span>((sfd = socket(res-&gt;ai_family, res-&gt;ai_socktype, res-&gt;ai_protocol)) == -1){</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: inet_connect failed&quot;</span>, who.c_str());</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">if</span>(do_listen) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="keywordflow">if</span>(setsockopt(sfd, SOL_SOCKET, SO_REUSEADDR, &amp;yes, <span class="keyword">sizeof</span>(yes)) == -1){</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: setscokopt failed&quot;</span>, who.c_str());</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                freeaddrinfo(servinfo);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="keywordflow">if</span>(<span class="keyword">true</span> == is_non_blocking)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                <span class="keywordtype">bool</span> ret_non_blocking = <a class="code" href="../../d5/dd1/inet__socket_8cpp.html#a70c25ed2ad4733bb8647266c4f8b6ad1">SetSocketNonBlocking</a>(sfd, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                <span class="keywordflow">if</span>(<span class="keyword">false</span> == ret_non_blocking)</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: Failed to set socket in non blocking mode&quot;</span>, who.c_str());</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    close(sfd);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">if</span>(bind(sfd, res-&gt;ai_addr, res-&gt;ai_addrlen) == -1){</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: socket bind failed&quot;</span>, who.c_str());</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            close(sfd);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span>(do_listen &amp;&amp; res != NULL){</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">if</span>(listen(sfd, backlog) == -1){</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <a class="code" href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a>-&gt;Log(<span class="stringliteral">&quot;%s:: listen failed&quot;</span>, who.c_str());</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            freeaddrinfo(servinfo);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        }       </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    *listen_fd = sfd;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    freeaddrinfo(servinfo);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">return</span> (res != NULL ) ? sfd : -1;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/dc9/inet__socket_8h.html#a3991cc2a47971acd778951add228bbc5">inet_bind</a></div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="../../d5/dd1/inet__socket_8cpp.html#a659a3f413bba10f654c19e9b9b7ea834">  458</a></span>&#160;(</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *host,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* service, </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordtype">int</span> sock_type,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordtype">int</span> *connect_fd,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordtype">bool</span>  is_non_blocking</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;{</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d9/dc9/inet__socket_8h.html#a19ae7ff2c55d9c114a8effdcf9fae870">inet_passive</a>(host, service, sock_type, <a class="code" href="../../d9/dc9/inet__socket_8h.html#aaa31440706ba11d449ccebfb07611495">NOT_LISTEN</a>, 0, connect_fd, is_non_blocking);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;}</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/dc9/inet__socket_8h.html#a9cde5897d9693cc6ad14bed0e118a656">inet_listen</a></div>
<div class="line"><a name="l00485"></a><span class="lineno"><a class="line" href="../../d5/dd1/inet__socket_8cpp.html#a9cde5897d9693cc6ad14bed0e118a656">  485</a></span>&#160;(</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *host,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* service, </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordtype">int</span> sock_type,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordtype">int</span> *listen_fd,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordtype">bool</span> is_non_blocking</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;)</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;{</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d9/dc9/inet__socket_8h.html#a19ae7ff2c55d9c114a8effdcf9fae870">inet_passive</a>(host, service, sock_type, <a class="code" href="../../d9/dc9/inet__socket_8h.html#af1c5743a8f0c628d60a7a3ad85981765">LISTEN</a>, <a class="code" href="../../d9/dc9/inet__socket_8h.html#aeefbbafa97642defe3ee6c3080b7d66f">BACKLOG</a>, listen_fd, is_non_blocking);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;}</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="ttc" id="inet__socket_8h_html_a3991cc2a47971acd778951add228bbc5"><div class="ttname"><a href="../../d9/dc9/inet__socket_8h.html#a3991cc2a47971acd778951add228bbc5">inet_bind</a></div><div class="ttdeci">int inet_bind(const char *service, int sock_type, int *listen_fd, bool is_non_blocking)</div></div>
<div class="ttc" id="inet__socket_8cpp_html_a70c25ed2ad4733bb8647266c4f8b6ad1"><div class="ttname"><a href="../../d5/dd1/inet__socket_8cpp.html#a70c25ed2ad4733bb8647266c4f8b6ad1">SetSocketNonBlocking</a></div><div class="ttdeci">bool SetSocketNonBlocking(const int fd, bool is_non_blocking)</div><div class="ttdoc">: Internal method to set the O_NONBLOCK (non-blocking) attribute of a file descriptior. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd1/inet__socket_8cpp_source.html#l00147">inet_socket.cpp:147</a></div></div>
<div class="ttc" id="inet__socket_8h_html_a294867ba9d7ff47e39d421134d8e12ab"><div class="ttname"><a href="../../d9/dc9/inet__socket_8h.html#a294867ba9d7ff47e39d421134d8e12ab">get_in_addr</a></div><div class="ttdeci">void * get_in_addr(struct sockaddr *sa)</div><div class="ttdoc">: get sockaddr, IPv4 or IPv6 ip address Note: Used in inet_ntop method. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd1/inet__socket_8cpp_source.html#l00015">inet_socket.cpp:15</a></div></div>
<div class="ttc" id="inet__socket_8h_html_a4ee3418bf7bd63c0b37ba13023d3e1cc"><div class="ttname"><a href="../../d9/dc9/inet__socket_8h.html#a4ee3418bf7bd63c0b37ba13023d3e1cc">inet_connect_blocking</a></div><div class="ttdeci">int inet_connect_blocking(const char *host, const char *service, int socket_type, int *connect_fd)</div><div class="ttdoc">:Blocking connect call for the client. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd1/inet__socket_8cpp_source.html#l00171">inet_socket.cpp:171</a></div></div>
<div class="ttc" id="inet__socket_8h_html_aeefbbafa97642defe3ee6c3080b7d66f"><div class="ttname"><a href="../../d9/dc9/inet__socket_8h.html#aeefbbafa97642defe3ee6c3080b7d66f">BACKLOG</a></div><div class="ttdeci">#define BACKLOG</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dc9/inet__socket_8h_source.html#l00007">inet_socket.h:7</a></div></div>
<div class="ttc" id="readLine_8h_html"><div class="ttname"><a href="../../d3/d61/readLine_8h.html">readLine.h</a></div></div>
<div class="ttc" id="common_2README_html_afe75ee0c7e5a90ba6bb38426ea69b996"><div class="ttname"><a href="../../d2/d3d/common_2README.html#afe75ee0c7e5a90ba6bb38426ea69b996">errno</a></div><div class="ttdeci">except that a terminating newline character is automatically appended to the output string The such as plus the error description as returned by but also terminates the by calling but differs in two except that instead of printing the error text corresponding to the current value of errno</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d3d/common_2README_source.html#l00028">README:28</a></div></div>
<div class="ttc" id="inet__socket_8h_html_a0d17436cdcdef6e93730b193008e9de8"><div class="ttname"><a href="../../d9/dc9/inet__socket_8h.html#a0d17436cdcdef6e93730b193008e9de8">get_peer_addr_with_peer_conn_fd</a></div><div class="ttdeci">int get_peer_addr_with_peer_conn_fd(const int fd, char *peer_name, unsigned short *port)</div><div class="ttdoc">: get sockaddr, IPv4 or IPv6 IP address and port number Note: Used to get the connecting client IP ad...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd1/inet__socket_8cpp_source.html#l00104">inet_socket.cpp:104</a></div></div>
<div class="ttc" id="inet__socket_8h_html_aaa31440706ba11d449ccebfb07611495"><div class="ttname"><a href="../../d9/dc9/inet__socket_8h.html#aaa31440706ba11d449ccebfb07611495">NOT_LISTEN</a></div><div class="ttdeci">#define NOT_LISTEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dc9/inet__socket_8h_source.html#l00006">inet_socket.h:6</a></div></div>
<div class="ttc" id="inet__socket_8h_html_a9cde5897d9693cc6ad14bed0e118a656"><div class="ttname"><a href="../../d9/dc9/inet__socket_8h.html#a9cde5897d9693cc6ad14bed0e118a656">inet_listen</a></div><div class="ttdeci">int inet_listen(const char *host, const char *service, int sock_type, int *listen_fd, bool is_non_blocking)</div><div class="ttdoc">: This function creates a listening stream (SOCK_STREAM) socket bound to the wildcard IP address on t...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd1/inet__socket_8cpp_source.html#l00485">inet_socket.cpp:485</a></div></div>
<div class="ttc" id="inet__socket_8h_html_a9cff4ecb4076bdcf7b759c9834d1f99b"><div class="ttname"><a href="../../d9/dc9/inet__socket_8h.html#a9cff4ecb4076bdcf7b759c9834d1f99b">get_in_port</a></div><div class="ttdeci">in_port_t get_in_port(struct sockaddr *sa)</div><div class="ttdoc">: get sockaddr, IPv4 or IPv6 port number Note: Used in ntohs method. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd1/inet__socket_8cpp_source.html#l00036">inet_socket.cpp:36</a></div></div>
<div class="ttc" id="CLogger_8h_html_aa385268d3ec7b4d3ecceb7c787171bf0"><div class="ttname"><a href="../../d4/d31/CLogger_8h.html#aa385268d3ec7b4d3ecceb7c787171bf0">LOGGER</a></div><div class="ttdeci">#define LOGGER</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d31/CLogger_8h_source.html#l00004">CLogger.h:4</a></div></div>
<div class="ttc" id="inet__socket_8h_html_a19ae7ff2c55d9c114a8effdcf9fae870"><div class="ttname"><a href="../../d9/dc9/inet__socket_8h.html#a19ae7ff2c55d9c114a8effdcf9fae870">inet_passive</a></div><div class="ttdeci">int inet_passive(const char *host, const char *service, int socket_type, bool do_listen, int backlog, int *listen_fd, bool is_non_blocking=false)</div><div class="ttdoc">: Server side socket preparation method. It performs following tasks. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd1/inet__socket_8cpp_source.html#l00362">inet_socket.cpp:362</a></div></div>
<div class="ttc" id="inet__socket_8h_html_af1c5743a8f0c628d60a7a3ad85981765"><div class="ttname"><a href="../../d9/dc9/inet__socket_8h.html#af1c5743a8f0c628d60a7a3ad85981765">LISTEN</a></div><div class="ttdeci">#define LISTEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dc9/inet__socket_8h_source.html#l00005">inet_socket.h:5</a></div></div>
<div class="ttc" id="inet__socket_8h_html_a88cba87b27a1dd999f206d996767578f"><div class="ttname"><a href="../../d9/dc9/inet__socket_8h.html#a88cba87b27a1dd999f206d996767578f">get_peer_addr_with_peer_sock</a></div><div class="ttdeci">int get_peer_addr_with_peer_sock(const struct sockaddr *peer_sock, char *peer_name, unsigned short *port)</div><div class="ttdoc">: get sockaddr, IPv4 or IPv6 IP address and port number Note: Used to get the connecting client IP ad...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd1/inet__socket_8cpp_source.html#l00062">inet_socket.cpp:62</a></div></div>
<div class="ttc" id="inet__socket_8h_html"><div class="ttname"><a href="../../d9/dc9/inet__socket_8h.html">inet_socket.h</a></div></div>
<div class="ttc" id="CLogger_8h_html"><div class="ttname"><a href="../../d4/d31/CLogger_8h.html">CLogger.h</a></div></div>
<div class="ttc" id="inet__socket_8h_html_ab37ff95ca876cde433bb18cca94956f2"><div class="ttname"><a href="../../d9/dc9/inet__socket_8h.html#ab37ff95ca876cde433bb18cca94956f2">inet_connect_non_blocking</a></div><div class="ttdeci">int inet_connect_non_blocking(const char *host, const char *service, int socket_type, int *connect_fd)</div><div class="ttdoc">:Non Blocking connect call for the client. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd1/inet__socket_8cpp_source.html#l00246">inet_socket.cpp:246</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_d61e5ac0c0dd8a2f58b850debc7bb838.html">tcpSocket</a></li><li class="navelem"><a class="el" href="../../dir_c5f260f06f8ea0c7169cb637da2cda86.html">source</a></li><li class="navelem"><a class="el" href="../../d5/dd1/inet__socket_8cpp.html">inet_socket.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
